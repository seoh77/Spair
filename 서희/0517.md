### 2024. 05. 17. 금요일

# Daily 회고


### 📍 작업 내용
- 게시판 상세보기 페이지로 이동 시 url에 postId가 동적으로 라우팅되지 않는 문제 해결 (공통)
- 게시판 상세보기 페이지에서 작성자와 스포츠센터 주소가 보이지 않는 문제 해결 (공통)
- 로그인 ID 중복확인, 닉네임 중복확인 백엔드 API 수정 후 프론트 연결
- 도로명 주소 API를 사용하여 사용자 주소 입력
- 카카오 API를 활용하여 입력받은 사용자 주소의 위도, 경도 값 가져오기
- 회원가입 페이지의 입력받아야 하는 각 항목의 상태에 따라 적절한 안내 문구가 표시되도록 수정
- 회원가입 페이지의 입력받아야 하는 모든 항목에 값이 입력되었을 때 회원가입 버튼 활성화
- 회원가입 버튼을 클릭하면 백엔드에서 만들어둔 회원가입 API를 사용하여 회원가입 가능
- 회원가입 성공 시 로그인 페이지로 이동


### 📍 회고

**게시판 상세보기 페이지의 url에 postId가 동적으로 라우팅되지 않는 문제**

> 게시판 상세보기 페이지로 이동할 때 url에 postId가 동적으로 라우팅되어야 해당 postId의 데이터를 가져올 수 있는데, 동적으로 라우팅되지 않는 이슈가 있었다. url에는 해당 postId가 아닌 `undefined`로 표시되는 상황이었다. 우선 `undefined`로 표시된다는 것은 변수가 제대로 할당되지 않았을 확률이 높다고 생각하여 해당 코드를 확인하였고, RouterLink에 `${board.postId}`가 아닌`${board.id}`로 적혀있는 것을 발견하였다. 임시 데이터에서는 id로 값을 할당했지만 실제 데이터는 postId로 값이 넘어왔고, 이를 수정해주지 않으면서 이슈가 발생하였다. 이를 통해 임시 데이터를 만들 때 가급적이면 실제 받아오는 데이터와 같은 변수명으로 설정하여 실수할 확률을 줄이고, 실수를 하더라도 지금처럼 어떤 값이, 어떤 형태로 넘어오는지 우선적으로 확인하고 원인을 찾으면 좀 더 빠르게 문제를 해결할 수 있다는 것을 배웠다.

<br />

**게시판 상세보기 페이지에서 작성자와 스포츠센터 주소가 보이지 않는 문제**

> 게시글 상세보기 페이지에서 API로 데이터를 가져와서 화면에 보여줄 때, `board.title` , `board.price` 와 같은 값들은 문제없이 가져와지는데 `board.user.nickname` , `board.sportsCenter.roadAddress`와 같이 board 내부 변수에 객체가 할당되어있고, 해당 객체 내부에 있는 변수의 값을 가져와야 하는 부분에서 값을 찾을 수 없다며 계속 에러가 발생하였다. 해당 이슈는 `user` 변수와 `sportsCenter` 변수를 따로 만들고, API를 호출하여 `board`에 값을 넣어줄 때 `user`와 `sportsCenter` 변수에도 각각 `board.user`, `board.sportsCenter` 객체를 할당해주는 것으로 해결하였다. 문제를 해결하긴 했으나 왜 이런 이슈가 발생하였는지는 아직 잘 모르겠다.

<br />

**로그인ID 중복확인과 닉네임 중복확인 API `POST`에서 `GET`으로 수정**

> 로그인ID 중복확인과 닉네임 중복확인 API는 둘 다 `POST`로 개발하였다. 로그인ID와 닉네임 모두 개인정보니까 POST로 전달하는게 좋지않을까 하여 POST로 개발하였는데, 프론트에서 request body에 담아 전달하는 과정에서 이슈가 발생했다. 우선 request body에 객체가 아닌 문자열을 그대로 담아 보내면 `=` 문자가 자동으로 붙어서 백엔드로 넘어가지면서 정상적으로 중복확인 기능이 동작하지 않았다. 이를 해결하기 위해 프론트에서 객체 형태로 전달하고 백엔드에서는 `public User(String loginId){ tihs.loginId = loginId }`와 `public User(String nickname) { this.nickname = nickname }` 와 같이 User DTO에서 생성자만 추가하고자 했으나 loginId와 nickname 둘 다 String이기 떄문에 오버로딩을 할 수 없었다. 이후 각 중복확인을 위한 DTO를 추가로 만드는 것과 `GET` 요청으로 수정하는 것 중 어떤 방식이 더 좋을지 고민하였다. 선정언니와 토의 끝에 loginId와 nickname은 `GET` 요청으로 전송해도 될 것 같다고 결론을 내렸고, `POST` 요청으로 만들어둔 API를 `GET` 요청으로 수정하여 로그인ID와 닉네임 중복확인 기능을 구현하였다.

<br />

**사용자의 주소와 위도, 경도 값 입력**

> 우리 프로젝트는 사용자 주소의 반경 1km를 '우리 동네'로 설정하고 우리 동네의 게시글만 선별하여 보여주는 기능이 있기 때문에 회원가입 시 사용자의 주소와 위도, 경도 값을 모두 입력받아야 한다. 사용자가 집 주소를 입력할 때는 지도에서 선택하는 것보다 도로명 주소 API를 활용하여 검색만으로도 쉽게 위치를 입력할 수 있도록 하려고 했으나 우리가 사용하고자 했던 행정안전부 도로명주소 API와 카카오 도로명 주소 API는 모두 주소만 반환할 뿐 위도, 경도 값은 반환해주지 않았다. 이를 해결하기 위해 우리가 생각한 방법은 총 3가지이다. 첫 번째는 카카오맵 API를 사용하기, 두 번째는 행정안전부 도로명주소 API에서 좌표제공 API로 신청할 경우 UTM-K 좌표계의 x좌표와 y좌표 값이 반환되는데 이 값을 경위도(좌표계:WGS84)로 변환하여 사용하기, 세 번째는 사용자는 도로명 주소 API를 사용하여 주소를 입력하면 입력받은 데이터로 내부에서 카카오 API를 사용하여 위도, 경도 값을 가져오기 였다. 이 중 첫 번째 방법은 사용자가 지도를 움직이고 클릭하는 것보다 자신의 주소를 검색하는게 사용자 관점에서 더 편할 것 같다는 생각이 들어 탈락되었고, 두 번째 방법은 과거에는 좌표제공 API가 개발 용도로도 사용이 가능했지만 현재는 운영 용도로만 신청이 가능하여 잠시 보류하고 마지막 세 번째 방법을 먼저 구현해보는 것으로 결정하였다. 

<br />

**도로명 주소 API와 카카오 API 사용**

> 도로명 주소 API는 따로 인증키가 필요하지 않아 별다른 이슈없이 API를 사용할 수 있었다. 하지만 카카오 API는 인증키 때문에 401에러가 계속 발생혔다. 문제가 발생한 원인은 크게 2가지이다. 첫번째는 env파일의 변수명 설정 문제로, env 파일에 카카오 API 인증키를 할당한 변수 앞에 `VUE_APP_` 을 붙여 작성했는데 우리 프로젝트는 VITE를 사용하기 때문에 `VUE_APP_` 이 아닌 `VITE_`을 붙여야 했다. 두번째는 Authorization 헤더에 `import.meta.env.VITE_KAKAO_REST_API_KEY`만 담아 전송했는데, 응답 메세지를 확인해보니 KaKaoAK가 없다고 적혀있었고 다시 공식문서를 확인해보니 `Authorization: KakaoAK ${REST_API_KEY}` 형태로 보내야 하는 것을 발견했다. 이후 형식에 맞춰 다시 API를 호출하니 정상적으로 데이터를 받아올 수 았었다. 이를 통해 API 요청에 실패해서 에러가 발생했을 때 상태코드만 보지 말고 내부에 message도 확인해야 하며, open API를 사용할 때는 어떤 부분들을 특히 꼼꼼하게 확인해야하는지를 배울 수 있었다.

<br />

**회원가입 페이지 각 input 항목의 상태에 따라 적절한 안내 문구 표시**

> 수정 전에는 기본 값으로 경고 문구를 출력하고, 각 조건을 충족했을 경우에 확인 문구가 출력되는 형식으로 코드를 구현하였다. 예를 들어 비밀번호 확인에서는 기본 값으로 '비밀번호가 일치하지 않습니다.'가 표시되고, 비밀번호가 일치한 경우에만 '비밀번호가 일치합니다.'로 수정되는 방식이었다. 하지만 아직 사용자가 아무런 입력도 하지 않은 상태에서 바로 경고 문구가 출력되는 것이 신경쓰이기도 했고, 무엇보다 경고 메세지도 상황에 따라 다르게 출력되어야 할 것 같다고 느꼈다. 따라서 각 input 항목의 상태에 따라 다른 안내 문구가 표시되도록 리팩토링하였다. loginId 항목에 대해서만 수정사항을 적어보자면 기존에는 `사용 가능한 ID입니다.` 또는 `영어, 숫자만 포함하여 5글자 이상으로 설정해주세요.`만 표시되었다면 수정 후에는 `이미 존재하는 ID입니다.`와 `ID 중복 확인을 진행해주세요.` 안내문구를 추가하여 상황에 맞는 문구가 출력되도록 수정하였다.